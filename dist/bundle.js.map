{"version":3,"sources":["webpack:///webpack/bootstrap 2b2787b5936f0bd9c1f4","webpack:///./src/test.js","webpack:///./test/applyMiddleware.js","webpack:///./src/index.js","webpack:///./src/middlewares/promise.js","webpack:///./src/middlewares/thunk.js"],"names":["require","initState","a","b","c","REDUCE_1","reducer","state","action","type","playload","logger","store","console","log","getState","next","subsribe","dispatch","Promise","resolve","reject","setTimeout","createStore","applyMiddleware","listeners","_dispatch","forEach","listener","push","filter","l","combineReducer","reducers","Object","keys","key","middlewares","mds","map","m","reduceRight","previous","current","promiseMiddleware","then","result","error","thunk"],"mappings":"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","file":"./dist/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 2b2787b5936f0bd9c1f4\n **/","// require('../test/mydux')\n// require('../test/combineReducer')\nrequire('../test/applyMiddleware')\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/test.js\n **/","import { createStore, applyMiddleware } from '../src'\nimport promiseMiddleware from '../src/middlewares/promise'\nimport thunk from '../src/middlewares/thunk'\n\nvar initState = {\n  a: 1,\n  b: 2,\n  c: 3,\n  REDUCE_1: 10\n}\n\nvar reducer = function (state, action) {\n  switch (action.type) {\n    case 'REDUCE_1':\n      state.REDUCE_1++\n      return state\n    case 'Sync':\n      state.REDUCE_1 += action.playload\n      return state\n    default:\n      return state\n  }\n}\n\n// 注意action是否可以修改咧，比如支持promise的action\nvar logger = (store) => next => action => {\n  console.log('开始接受之前的状态', store.getState())\n  next(action)\n  console.log('结束接受之后的状态', store.getState())\n}\n\nvar store = createStore(\n  reducer,\n  initState,\n  applyMiddleware(thunk, promiseMiddleware, logger)\n )\n\nstore.subsribe(function () {\n  console.log('we got new state: ', store.getState())\n})\n\n// Promise\nstore.dispatch(new Promise((resolve, reject) => {\n  setTimeout(() => {\n    resolve({\n      type: 'Sync',\n      playload: 23333\n    })\n  }, 2000)\n}))\n\n// thunk\nstore.dispatch((dispatch) => {\n  setTimeout(() => {\n    dispatch({\n      type: 'Sync',\n      playload: 11111111\n    })\n  }, 2000)\n})\n\n\n\n/** WEBPACK FOOTER **\n ** ./test/applyMiddleware.js\n **/","export var createStore = function (reducer, initState = {}, applyMiddleware) {\n  if (typeof initState === 'function') {\n    applyMiddleware = initState\n    initState = {}\n  }\n  var state = initState\n  var listeners = []\n  var _dispatch = function _dispatch (action) {\n    state = reducer(state, action)\n    listeners.forEach(listener => listener())\n  }\n  var dispatch = function (action) {\n    if (applyMiddleware) {\n      applyMiddleware({\n        dispatch: _dispatch,\n        getState\n      }, action)\n    } else {\n      _dispatch(action)\n    }\n  }\n\n  var subsribe = function subsribe (listener) {\n    listeners.push(listener)\n    return () => {\n      listeners = listeners.filter(l => l !== listener)\n    }\n  }\n  var getState = function getState () {\n    return state\n  }\n  return {\n    dispatch,\n    subsribe,\n    getState\n  }\n}\n// 返回一个大大的reducer\n// 有个约定就是，reducer的属性名需要与state的属性名一致\nexport var combineReducer = function combineReducer (reducers) {\n  return (state, action) => {\n    Object.keys(reducers).forEach(key => {\n      state[key] = reducers[key](state[key], action)\n    })\n    return state\n  }\n}\n\n// export var applyMiddleware = function applyMiddleware (middleware1， middleware2) {\nexport var applyMiddleware = function applyMiddleware (...middlewares) {\n  return (store, action) => {\n    // middleware1(middleware2(dispatch))(action)\n    // 如果倒叙的话就不用这样转了\n    var mds = middlewares.map(m => m(store))\n    mds.reduceRight((previous, current) => {\n      return current(previous)\n    }, store.dispatch)(action)\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/index.js\n **/","export default function promiseMiddleware (store) {\n  return next => action => {\n    // 判断action是否是promise方法\n    if (typeof action.then === 'function') {\n      action.then(\n        result => {\n          next(result)\n        },\n        error => {\n          store.dispatch({...action, playload: error})\n          return Promise.reject(error)\n        })\n    } else if (action.playload && typeof action.playload.then === 'function') {\n      action.playload.then(\n        result => {\n          next(result)\n        },\n        error => {\n          store.dispatch({...action, playload: error})\n          return Promise.reject(error)\n        })\n    } else {\n      next(action)\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/middlewares/promise.js\n **/","export default function thunk (store) {\n  return next => action => {\n    if (typeof action === 'function') {\n      action(next)\n    } else {\n      next(action)\n    }\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/middlewares/thunk.js\n **/"],"sourceRoot":""}